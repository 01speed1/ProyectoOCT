"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseReduce = Promise.reduce;
var PromiseAll = Promise.all;

function promiseAllThis() {
    return PromiseAll(this);
}

function PromiseMapSeries(promises, fn) {
    return PromiseReduce(promises, fn, INTERNAL, INTERNAL);
}

Promise.prototype.each = function (fn) {
<<<<<<< HEAD
    return PromiseReduce(this, fn, INTERNAL, 0)
              ._then(promiseAllThis, undefined, undefined, this, undefined);
=======
    return this.mapSeries(fn)
            ._then(promiseAllThis, undefined, undefined, this, undefined);
>>>>>>> 61e6907ab66902c521df8d20bf4a0ef28a1873df
};

Promise.prototype.mapSeries = function (fn) {
    return PromiseReduce(this, fn, INTERNAL, INTERNAL);
};

Promise.each = function (promises, fn) {
<<<<<<< HEAD
    return PromiseReduce(promises, fn, INTERNAL, 0)
              ._then(promiseAllThis, undefined, undefined, promises, undefined);
=======
    return PromiseMapSeries(promises, fn)
            ._then(promiseAllThis, undefined, undefined, promises, undefined);
>>>>>>> 61e6907ab66902c521df8d20bf4a0ef28a1873df
};

Promise.mapSeries = PromiseMapSeries;
};
<<<<<<< HEAD

=======
>>>>>>> 61e6907ab66902c521df8d20bf4a0ef28a1873df
